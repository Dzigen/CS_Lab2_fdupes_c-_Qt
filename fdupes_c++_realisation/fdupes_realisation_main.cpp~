#include <iostream>
#include<cstdlib>
#include<cstdio>

#include <map>
#include <list>
#include <string>

#include "dir_iterator_size_hash_insert.h"

using namespace std;

int main(int argc, char *argv[])
{


    /*Проверка на указание директории */
    if (argc < 2) {
        fprintf(stderr, "Usage: %s directory\n", argv[0]);
        exit(EXIT_FAILURE);
    }

   /**
     *  Инициализируем хранилице 
     *  размеров , хэшей и имён файлов в заданном каталоге
     */
    map < int, map < int, list < string > > >data_base_files;


    /**  
     *  Инициализируем хранилище дубликатов файлов в заданном каталоге
     */
    map < int, list < string > >duplicats;

   /***
     *  Двигаемся по файлам заданного каталога
     *  и заносим их размер ,хэш и имя в базу двнных data_base_files
     */
    dir_iterator(argv[1], &data_base_files);

    /* for (map < int, map < int, list < string > > >::iterator it =
       data_base_files.begin(); it != data_base_files.end(); it++) {
       cout << it->first << endl;
       for (map < int, list < string > >::iterator ut =
       it->second.begin(); ut != it->second.end(); ut++) {
       cout << "  " << ut->first << endl;
       for (list < string >::iterator ptr = ut->second.begin();
       ptr != ut->second.end(); ptr++)
       cout << "    " << *ptr << endl;
       }
       } */


   /**
     *
     */
    comparing_files(&data_base_files, &duplicats);

    /**
	  *
	  */
    user_interface(&duplicats);

    return 0;
}
